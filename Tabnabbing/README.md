[原文文档](README.en.md)

# 标签页劫持

> 反向标签页劫持是一种攻击方式，其中从目标页面链接的页面能够重写该页面，例如将其替换为钓鱼网站。由于用户最初在正确的页面上，他们不太可能注意到页面已被更改为钓鱼网站，特别是如果该网站看起来与目标相同。如果用户向这个新页面进行身份验证，那么他们的凭证（或其他敏感数据）将被发送到钓鱼网站而不是合法网站。

## 概述

* [工具](#工具)
* [方法论](#方法论)
* [利用](#利用)
* [发现](#发现)
* [参考文献](#参考文献)

## 工具

* [PortSwigger/discovering-reversetabnabbing](https://portswigger.net/bappstore/80eb8fd46bf847b4b17861482c2f2a30) - 发现反向标签页劫持

## 方法论

在进行标签页劫持时，攻击者搜索插入到网站中并受其控制的链接。例如，此类链接可能包含在论坛帖子中。一旦他找到了这种功能，就会检查链接的 `rel` 属性不包含值 `noopener` 且 target 属性包含值 `_blank`。如果是这样的话，网站就容易受到标签页劫持攻击。

## 利用

1. 攻击者发布一个指向受其控制网站的链接，该链接包含以下 JS 代码：`window.opener.location = "http://evil.com"`
2. 他欺骗受害者访问该链接，该链接在浏览器的新标签页中打开。
3. 同时执行 JS 代码，后台标签页被重定向到 evil.com 网站，这很可能是一个钓鱼网站。
4. 如果受害者再次打开后台标签页且没有查看地址栏，可能会认为已注销，因为出现了登录页面等。
5. 受害者尝试重新登录，攻击者获取凭证

## 发现

搜索以下链接格式：

```html
<a href="..." target="_blank" rel=""> 
<a href="..." target="_blank">
```

## 参考文献

* [反向标签页劫持 - OWASP - 2020年10月20日](https://owasp.org/www-community/attacks/Reverse_Tabnabbing)
* [标签页劫持 - 维基百科 - 2010年5月25日](https://en.wikipedia.org/wiki/Tabnabbing)