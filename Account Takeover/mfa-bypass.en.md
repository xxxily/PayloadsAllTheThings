[原文文档](mfa-bypass.en.md)

# MFA 绕过

> 多因素认证 (MFA) 是一种安全措施，要求用户提供两个或多个验证因素才能访问系统、应用程序或网络。它结合了用户知道的内容（如密码）、用户拥有的内容（如手机或安全令牌）和/或用户自身的特征（生物识别验证）。这种分层方法通过使未经授权的访问更加困难来增强安全性，即使密码被泄露也是如此。
> MFA 绕过是攻击者用来规避 MFA 保护的技术。这些方法可以包括利用 MFA 实现中的弱点、拦截认证令牌、利用社会工程学操纵用户或支持人员，或利用基于会话的漏洞。

## 概要

* [响应操纵](#响应操纵)
* [状态码操纵](#状态码操纵)
* [响应中的 2FA 代码泄露](#响应中的-2fa-代码泄露)
* [JS 文件分析](#js-文件分析)
* [2FA 代码可重用性](#2fa-代码可重用性)
* [缺乏暴力破解保护](#缺乏暴力破解保护)
* [缺少 2FA 代码完整性验证](#缺少-2fa-代码完整性验证)
* [禁用 2FA 的 CSRF](#禁用-2fa-的-csrf)
* [密码重置禁用 2FA](#密码重置禁用-2fa)
* [备份代码滥用](#备份代码滥用)
* [2FA 禁用页面的点击劫持](#2fa-禁用页面的点击劫持)
* [启用 2FA 不会使之前活动的会话过期](#启用-2fa-不会使之前活动的会话过期)
* [通过强制浏览绕过 2FA](#通过强制浏览绕过-2fa)
* [使用 null 或 000000 绕过 2FA](#使用-null-或-000000-绕过-2fa)
* [使用数组绕过 2FA](#使用数组绕过-2fa)

## 2FA 绕过

### 响应操纵

在响应中如果 `"success":false`
将其更改为 `"success":true`

### 状态码操纵

如果状态码是 **4xx**
尝试将其更改为 **200 OK** 并查看是否绕过限制

### 响应中的 2FA 代码泄露

检查 2FA 代码触发请求的响应，查看代码是否泄露。

### JS 文件分析

虽然罕见，但一些 JS 文件可能包含有关 2FA 代码的信息，值得一试

### 2FA 代码可重用性

同一代码可以重复使用

### 缺乏暴力破解保护

可以暴力破解任意长度的 2FA 代码

### 缺少 2FA 代码完整性验证

任何用户账户的代码都可用于绕过 2FA

### 禁用 2FA 的 CSRF

禁用 2FA 时没有 CSRF 保护，也没有身份验证确认

### 密码重置禁用 2FA

在密码更改/邮箱更改时 2FA 会被禁用

### 备份代码滥用

通过滥用备份代码功能绕过 2FA
使用上述技术绕过备份代码以移除/重置 2FA 限制

### 2FA 禁用页面的点击劫持

通过 iframe 包装 2FA 禁用页面并进行社会工程学攻击，诱使受害者禁用 2FA

### 启用 2FA 不会使之前活动的会话过期

如果会话已经被劫持且存在会话超时漏洞

### 通过强制浏览绕过 2FA

如果应用程序在禁用 2FA 时登录重定向到 `/my-account` URL，请尝试在启用 2FA 时将 `/2fa/verify` 替换为 `/my-account` 以绕过验证。

### 使用 null 或 000000 绕过 2FA

输入代码 **000000** 或 **null** 以绕过 2FA 保护。

### 使用数组绕过 2FA

```json
{
    "otp":[
        "1234",
        "1111",
        "1337", // GOOD OTP
        "2222",
        "3333",
        "4444",
        "5555"
    ]
}
```
